<!DOCTYPE html>
<html>
  <head>
    <title>Residual Diagnostics and Remedial Measures</title>
    <meta charset="utf-8">
    <meta name="author" content="Brandon M. Greenwell" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css/hygge.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Residual Diagnostics and Remedial Measures
## Lecture 04
### Brandon M. Greenwell
### 24 September, 2018

---

class: clear 



background-image: url(images/linear-algebra.jpg)


---
class: clear, middle

.large[

* Required reading

    - Chapters: 3, 6, and 10

    - Sections: 3.1-3.4, 3.7, 6.8, and 10.1-10.4

* Main topics:

    - Diagnostic and Remedial Measures (3.1-3.4, 3.7, 6.8,)
  
    - Model Adequacy and Outlying Observations (10.1-10.4)

]


---

# Prerquisites

.scrollable[

.medium[


```r
# List of required (CRAN) packages
pkgs &lt;- c(
  NULL
)

# Install required (CRAN) packages
for (pkg in pkgs) {
  if (!requireNamespace(pkg)) {  # check if already installed
    install.packages(pkg)  # install it
  }
}

# Install additional (optional) awesomeness
install.packages(c("devtools", "magick"))
devtools::install_github("bgreenwell/roundhouse")
```

]

]


---
class: clear, center, middle, inverse

.huger[

What are *residual diagnostics* and *remedial measures* and why do we need them?

]


---
class: clear, center, middle, inverse

.huger[

What's wrong with my model and how do I fix it?

]


---
class: clear 

.large[.bold[.center[.green[What are the typical assumptions of the linear regression model?]]]]

.large[

`$$Y_i = \beta_0 + \beta_1 X_{i1} + \dots + \beta_{p-1} X_{i, p-1} + \epsilon_i\\i = 1, 2, \dots, n$$`

]

--

.large[

* Independent observations: `\(Cov\left(\epsilon_i, \epsilon_j\right) = 0\)` `\(\left(i \ne j\right)\)`

]

--

.large[

* Constant variance: `\(Var\left(\epsilon_i\right) = Cov\left(\epsilon_i, \epsilon_i\right) = \sigma^2\)`

]

--

.large[

* Normally distributed errors: `\(\epsilon_i \stackrel{iid}{\sim} N\left(0, \sigma^2\right)\)` (.red[required for **traditional** statistical inference])

]

--

.large[

* We assume that we have the .bold[.darkorange[correct model]]!

]


---
class: clear, center, middle, inverse

.huger[

How do we know if the model is ~~wrong~~ bad?

]


---
class: clear, center, middle

.huger[What is a residual?]

--

.huge[ 

`\(e_i = Y_i - \widehat{Y}_i\)` 

.red[observed error = data - fit]

]


---

# What can they tell us?

.medium[

* Plot of residuals against predictor variable (checking non-linearity).

* Plot of absolute or squared residuals against predictor variable (check non-constant variance)

* Plot of residuals against fitted values (non-constant variance and non-linearity)

* Plot of residuals against time or another sequence (non-independence)

* Plot of residuals against omitted predictor variables (missing potentially important predictors)

* Boxplot of residuals (outlying observations)

* Normal probability plot of residuals (non-normality).

]


---
class: clear, middle, center

&lt;img src="lecture-04_files/figure-html/example-diagnostics-1.svg" width="70%" style="display: block; margin: auto;" /&gt;


---

# Residual analysis

.large[

* Residuals help in identifying a misspecified mean structure (i.e., `\(\boldsymbol{\beta}\boldsymbol{X}\)`)

* *Scaled residuals* help in identifying outliers or extreme values

* Common types of residuals:

    - Standardized Residuals
    
    - Studentized residuals
    
    - PRESS Residuals 

]


---
class: clear, middle, center

.huge[Normal Q-Q plot can be used to asses the "normalityness" of a set of observations]


---
class: clear 


```r
set.seed(101)
x &lt;- rnorm(100)
qqnorm(x, main = "Normal data")
qqline(x, lty = "dotted", col = "red2")
```

&lt;img src="lecture-04_files/figure-html/qqnorm-normal-1.svg" width="70%" style="display: block; margin: auto;" /&gt;


---
class: clear 


```r
set.seed(101)
x &lt;- rlnorm(100)
qqnorm(x, main = "Skew right data")
qqline(x, lty = "dotted", col = "red2")
```

&lt;img src="lecture-04_files/figure-html/qqnorm-skew-right-1.svg" width="70%" style="display: block; margin: auto;" /&gt;


---
class: clear 


```r
set.seed(101)
x &lt;- -rlnorm(100)
qqnorm(x, main = "Skew left data")
qqline(x, lty = "dotted", col = "red2")
```

&lt;img src="lecture-04_files/figure-html/qqnorm-skew-left-1.svg" width="70%" style="display: block; margin: auto;" /&gt;


---
class: clear 


```r
set.seed(101)
x &lt;- rt(100, df = 1)
qqnorm(x, main = "Heavy-tailed data")
qqline(x, lty = "dotted", col = "red2")
```

&lt;img src="lecture-04_files/figure-html/qqnorm-heavy tails-1.svg" width="70%" style="display: block; margin: auto;" /&gt;


---
class: clear, middle, center

.larger[When should you use normality tests?]

--

&lt;img src="lecture-04_files/figure-html/never-1.svg" width="50%" style="display: block; margin: auto;" /&gt;


---
class: clean, middle, center, inverse

.huge[Scaling the residuals]


---

# Standardized residuals




---
class: clear, middle, center

&lt;img src="lecture-04_files/figure-html/quittin-time-1.svg" width="60%" style="display: block; margin: auto;" /&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
